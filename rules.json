{
  "rules": [
    {
      "name": "Hardcoded Password",
      "extension": ".py",
      "regex": "^[^/#]*password\\s*=\\s*['\"]",
      "severity": "High",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Use secret storage or environment variables",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "Command Injection",
      "extension": ".py",
      "regex": "os\\.system\\([^)]",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "CVE-2021-4034",
      "recommendation": "Avoid shell=True and sanitize input",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1059"
    },
    {
      "name": "Hardcoded API Token",
      "extension": ".py",
      "regex": "^[^/#]*(api[_-]?key|token)\\s*=\\s*['\"][A-Za-z0-9\\-_]{16,}['\"]",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Move API tokens to secure secret storage",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "JWT Secret Hardcoded",
      "extension": ".py",
      "regex": "^[^/#]*jwt.*secret\\s*=\\s*['\"][^'\"]+",
      "severity": "High",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Use environment variables for JWT secrets",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "SQL Injection via String Concatenation",
      "extension": ".py",
      "regex": "^[^/#]*(SELECT|INSERT|UPDATE|DELETE).*(\\+|%s|\\$\\{)",
      "severity": "Critical",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Use parameterized queries",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1190"
    },
    {
      "name": "SSL Certificate Verification Disabled",
      "extension": ".py",
      "regex": "verify\\s*=\\s*False",
      "severity": "High",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Always enable SSL certificate validation",
      "category": "Network",
      "owasp": "A02:2021",
      "mitre": "T1040"
    },
    {
      "name": "Command Injection via User Input",
      "extension": ".py",
      "regex": "^[^/#]*(exec|eval|system|popen)\\(.*(request|input|params)",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Validate and sanitize all inputs",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1059"
    },
    {
      "name": "Dangerous Python Eval",
      "extension": ".py",
      "regex": "^[^/#]*eval\\s*\\(",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Avoid using eval; use safer alternatives",
      "category": "Execution",
      "owasp": "A03:2021",
      "mitre": "T1059"
    },
    {
      "name": "Insecure Deserialization",
      "extension": ".py",
      "regex": "^[^/#]*pickle\\.loads",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Avoid deserializing untrusted data",
      "category": "Deserialization",
      "owasp": "A08:2021",
      "mitre": "T1649"
    },
    {
      "name": "Subprocess with Shell",
      "extension": ".py",
      "regex": "subprocess\\.(Popen|run|call)\\(.*shell\\s*=\\s*True",
      "severity": "Critical",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Avoid shell=True in subprocess calls",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1059"
    },
    {
      "name": "Weak Cryptographic Hash",
      "extension": ".py",
      "regex": "^[^/#]*(md5|sha1)\\(",
      "severity": "High",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Use SHA-256 or stronger algorithms",
      "category": "Cryptography",
      "owasp": "A02:2021",
      "mitre": "T1040"
    },
    {
      "name": "Insecure Random",
      "extension": ".py",
      "regex": "^[^/#]*random\\.rand",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Use cryptographically secure random generators",
      "category": "Cryptography",
      "owasp": "A02:2021",
      "mitre": "T1027"
    },
    {
      "name": "Vulnerable Flask Version",
      "extension": "requirements.txt",
      "regex": "flask[=<>!~ ]*1\\.1\\.[0-2]\\b",
      "severity": "High",
      "confidence": "Sure",
      "cve": "CVE-2019-1010083",
      "recommendation": "Upgrade Flask to version >=1.1.4",
      "category": "Dependency",
      "owasp": "A06:2021",
      "mitre": "T1190"
    },
    {
      "name": "Vulnerable Django Version",
      "extension": "requirements.txt",
      "regex": "django[=<>!~ ]*(1\\.11\\.[0-9]|2\\.0\\.[0-8]|2\\.1\\.[0-4]|2\\.2\\.[0-8])\\b",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "CVE-2020-7471",
      "recommendation": "Upgrade Django to latest stable version",
      "category": "Dependency",
      "owasp": "A06:2021",
      "mitre": "T1190"
    },
    {
      "name": "Vulnerable Requests Version",
      "extension": "requirements.txt",
      "regex": "requests[=<>!~ ]*2\\.(0|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20|21|22|23)\\b",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "CVE-2018-18074",
      "recommendation": "Upgrade requests to version >=2.24.0",
      "category": "Dependency",
      "owasp": "A06:2021",
      "mitre": "T1190"
    },
    {
      "name": "Vulnerable PyYAML Version",
      "extension": "requirements.txt",
      "regex": "pyyaml[=<>!~ ]*5\\.1\\b",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "CVE-2019-20477",
      "recommendation": "Upgrade PyYAML to version >=5.3.1",
      "category": "Dependency",
      "owasp": "A06:2021",
      "mitre": "T1190"
    },
    {
      "name": "Vulnerable urllib3 Version",
      "extension": "requirements.txt",
      "regex": "urllib3[=<>!~ ]*(1\\.(0|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20|21|22|23|24|25)\\b|2\\.0\\.[0-2]\\b)",
      "severity": "High",
      "confidence": "Likely",
      "cve": "CVE-2021-33503",
      "recommendation": "Upgrade urllib3 to version >=1.26.5 or >=2.0.3",
      "category": "Dependency",
      "owasp": "A06:2021",
      "mitre": "T1190"
    }
  ]
}
