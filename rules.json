{
  "rules": [
    {
      "name": "Hardcoded Password",
      "extension": ".py",
      "regex": "password\\s*=\\s*['\\\"]",
      "severity": "High",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Use secret storage or environment variables",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "AWS Access Key",
      "extension": ".env",
      "regex": "AKIA[0-9A-Z]{16}",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Rotate compromised keys immediately",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "SQL Injection",
      "extension": ".php",
      "regex": "SELECT .*\\+.*\\$",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "CVE-2023-34362",
      "recommendation": "Use prepared statements",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1190"
    },
    {
      "name": "Command Injection",
      "extension": ".py",
      "regex": "os.system\\(|subprocess.Popen\\(.*shell=True",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "CVE-2021-4034",
      "recommendation": "Avoid shell=True and sanitize input",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1059"
    },
    {
      "name": "Log4Shell",
      "extension": ".java",
      "regex": "\\$\\{jndi:(ldap|rmi)",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "CVE-2021-44228",
      "recommendation": "Update Log4j to latest version",
      "category": "CVE",
      "owasp": "A06:2021",
      "mitre": "T1190"
    },
    {
      "name": "Docker running as root",
      "extension": "Dockerfile",
      "regex": "USER root",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Use non-root user",
      "category": "Misconfiguration",
      "owasp": "A05:2021",
      "mitre": "T1611"
    },
    {
      "name": "Hardcoded API Token",
      "extension": "*",
      "regex": "(api[_-]?key|token)\\s*=\\s*['\\\"][A-Za-z0-9\\-_]{16,}['\\\"]",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Move API tokens to secure secret storage",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "JWT Secret Hardcoded",
      "extension": "*",
      "regex": "jwt.*secret\\s*=\\s*['\\\"][^'\\\"]+",
      "severity": "High",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Use environment variables for JWT secrets",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "Database Credentials in Config",
      "extension": "*",
      "regex": "(db|database).*(user|pass|password)\\s*=",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Store DB credentials securely",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "Plaintext Private Key",
      "extension": "*",
      "regex": "-----BEGIN (RSA|EC|DSA|OPENSSH) PRIVATE KEY-----",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Remove private keys from source code",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "OAuth Client Secret",
      "extension": "*",
      "regex": "client_secret\\s*=\\s*['\\\"][^'\\\"]+",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Protect OAuth secrets using vaults",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "SQL Injection via String Concatenation",
      "extension": "*",
      "regex": "(SELECT|INSERT|UPDATE|DELETE).*(\\+|\\%s|\\$\\{)",
      "severity": "Critical",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Use parameterized queries",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1190"
    },
    {
      "name": "NoSQL Injection",
      "extension": "*",
      "regex": "\\$where\\s*:\\s*['\\\"]",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Avoid dynamic NoSQL queries",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1190"
    },
    {
      "name": "Command Injection via User Input",
      "extension": "*",
      "regex": "(exec|eval|system|popen)\\(.*(request|input|params)",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Validate and sanitize all inputs",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1059"
    },
    {
      "name": "Insecure Deserialization",
      "extension": "*",
      "regex": "(pickle.loads|unserialize|BinaryFormatter)",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Avoid deserializing untrusted data",
      "category": "Deserialization",
      "owasp": "A08:2021",
      "mitre": "T1649"
    },
    {
      "name": "Debug Mode Enabled",
      "extension": "*",
      "regex": "(DEBUG|debug)\\s*=\\s*true",
      "severity": "Medium",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Disable debug mode in production",
      "category": "Misconfiguration",
      "owasp": "A05:2021",
      "mitre": "T1600"
    },
    {
      "name": "Open CORS Policy",
      "extension": "*",
      "regex": "Access-Control-Allow-Origin\\s*:\\s*\\*",
      "severity": "Medium",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Restrict allowed origins",
      "category": "Misconfiguration",
      "owasp": "A05:2021",
      "mitre": "T1046"
    },
    {
      "name": "Insecure TLS Configuration",
      "extension": "*",
      "regex": "(TLSv1|SSLv3)",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Use TLS 1.2 or higher",
      "category": "Cryptography",
      "owasp": "A02:2021",
      "mitre": "T1040"
    },
    {
      "name": "Weak Cryptographic Hash",
      "extension": "*",
      "regex": "(md5|sha1)\\(",
      "severity": "High",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Use SHA-256 or stronger algorithms",
      "category": "Cryptography",
      "owasp": "A02:2021",
      "mitre": "T1040"
    },
    {
      "name": "Path Traversal",
      "extension": "*",
      "regex": "\\.\\./|\\.\\.\\\\",
      "severity": "High",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Normalize and validate file paths",
      "category": "Traversal",
      "owasp": "A01:2021",
      "mitre": "T1006"
    },
    {
      "name": "Exposed Admin Endpoint",
      "extension": "*",
      "regex": "/(admin|manage|root|dashboard)",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Restrict access to admin endpoints",
      "category": "Access Control",
      "owasp": "A01:2021",
      "mitre": "T1068"
    },
    {
      "name": "Unrestricted File Upload",
      "extension": "*",
      "regex": "(upload|file).*(accept|allow).*['\\\"]\\*['\\\"]",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Restrict allowed file types and validate uploads.",
      "category": "File Upload",
      "owasp": "A05:2021",
      "mitre": "T1105"
    },
    {
      "name": "Sensitive Data in URL",
      "extension": "*",
      "regex": "(password|api[_-]?key|token|secret)[=|%3D][^&'\" ]+",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Never transmit secrets in GET URLs.",
      "category": "Secrets",
      "owasp": "A01:2021",
      "mitre": "T1552"
    },
    {
      "name": "Default Credentials Used",
      "extension": "*",
      "regex": "(admin|root)[/:]?(admin|password|123456)",
      "severity": "Critical",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Change all default credentials before deployment.",
      "category": "Access Control",
      "owasp": "A07:2021",
      "mitre": "T1078"
    },
    {
      "name": "Dangerous Python Eval",
      "extension": ".py",
      "regex": "eval\\s*\\(",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Avoid using eval; use safer alternatives.",
      "category": "Execution",
      "owasp": "A03:2021",
      "mitre": "T1059"
    },
    {
      "name": "PHP Dangerous Functions",
      "extension": ".php",
      "regex": "(exec|shell_exec|system|passthru)\\s*\\(",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Do not use dangerous execution functions in PHP.",
      "category": "Execution",
      "owasp": "A03:2021",
      "mitre": "T1059"
    },
    {
      "name": "Insecure Random",
      "extension": "*",
      "regex": "(random\\.rand|Math\\.random)",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Use cryptographically secure random generators.",
      "category": "Cryptography",
      "owasp": "A02:2021",
      "mitre": "T1027"
    },
    {
      "name": "Sensitive Data in Comments",
      "extension": "*",
      "regex": "//.*(password|token|secret|key)\\s*[:=]",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Remove sensitive data from comments.",
      "category": "Information Disclosure",
      "owasp": "A01:2021",
      "mitre": "T1552"
    },
    {
      "name": "SSL Certificate Verification Disabled",
      "extension": "*.py",
      "regex": "verify\\s*=\\s*False",
      "severity": "High",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Always enable SSL certificate validation.",
      "category": "Network",
      "owasp": "A02:2021",
      "mitre": "T1040"
    },
    {
      "name": "Hardcoded IP Address",
      "extension": "*",
      "regex": "(\\b25[0-5]|\\b2[0-4][0-9]|\\b1[0-9]{2}|\\b[1-9][0-9]?|\\b0)\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Avoid hardcoded IP addresses; use DNS or environment variables.",
      "category": "Network",
      "owasp": "A06:2021",
      "mitre": "T1135"
    },
    {
      "name": "XML External Entity",
      "extension": "*",
      "regex": "<!ENTITY\\s+",
      "severity": "High",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Disable entity resolution in XML parsers.",
      "category": "XXE",
      "owasp": "A04:2021",
      "mitre": "T1221"
    },
    {
      "name": "CSRF Disabled",
      "extension": "*",
      "regex": "(csrf_protect|csrf_protection)[^a-zA-Z0-9]+(False|0)",
      "severity": "High",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Always enable CSRF protection.",
      "category": "Misconfiguration",
      "owasp": "A05:2021",
      "mitre": "T1110"
    },
    {
      "name": "URL Redirection",
      "extension": "*",
      "regex": "(redirect|window\\.location|location\\.href)\\s*[=:]\\s*(request|get|input|params)",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Validate all URLs for redirects.",
      "category": "Open Redirect",
      "owasp": "A10:2021",
      "mitre": "T1190"
    },
    {
      "name": "No Rate Limiting",
      "extension": "*",
      "regex": "(rate_limit|throttle).*[=:]\\s*None",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Implement proper rate limiting.",
      "category": "Misconfiguration",
      "owasp": "A07:2021",
      "mitre": "T1110"
    },
    {
      "name": "Sensitive Info in Exception",
      "extension": "*",
      "regex": "(Exception|Error)\\s*\\(.*(password|secret|token|key)",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Do not leak secrets via error messages.",
      "category": "Information Disclosure",
      "owasp": "A01:2021",
      "mitre": "T1592"
    },
    {
      "name": "World-Readable File Permissions",
      "extension": "*",
      "regex": "(chmod\\s+777|os.chmod\\([^,]+,\\s*0o777\\))",
      "severity": "Medium",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Use principle of least privilege for file permissions.",
      "category": "Misconfiguration",
      "owasp": "A05:2021",
      "mitre": "T1222"
    },
    {
      "name": "Unencrypted Connection String",
      "extension": "*",
      "regex": "jdbc:mysql://[^s]",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Use encrypted (SSL/TLS) connections for databases.",
      "category": "Cryptography",
      "owasp": "A02:2021",
      "mitre": "T1040"
    },
    {
      "name": "Deprecated Function Use",
      "extension": "*",
      "regex": "(gets|strcpy|scanf|strcat|eval|execscript)\\s*\\(",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Avoid deprecated or dangerous functions.",
      "category": "Code Quality",
      "owasp": "A06:2021",
      "mitre": "T1059"
    },
    {
      "name": "HTTP without HTTPS",
      "extension": "*",
      "regex": "http:\\/\\/(?!\\/\\/)",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Use HTTPS for all communications.",
      "category": "Network",
      "owasp": "A02:2021",
      "mitre": "T1040"
    },
    {
      "name": "LDAP Injection",
      "extension": "*",
      "regex": "(ldapsearch|DirectoryEntry|ldapquery).*\\+(.*request|input|params)",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Sanitize LDAP queries.",
      "category": "Injection",
      "owasp": "A03:2021",
      "mitre": "T1136"
    },
    {
      "name": "Weak SSH Cipher",
      "extension": "*",
      "regex": "(arcfour|cbc|des|3des|blowfish|rc4)",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Use strong ciphers for SSH.",
      "category": "Cryptography",
      "owasp": "A02:2021",
      "mitre": "T1040"
    },
    {
      "name": "Wildcard in Database Host",
      "extension": "*",
      "regex": "(host|hostname|DB_HOST)\\s*=\\s*['\\\"]%['\\\"]",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Do not allow wildcards in DB host settings.",
      "category": "Misconfiguration",
      "owasp": "A05:2021",
      "mitre": "T1565"
    },
    {
      "name": "Empty Password Allowed",
      "extension": "*",
      "regex": "(empty_password|allow_blank_password)\\s*=\\s*(1|true|True)",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Disallow empty passwords.",
      "category": "Access Control",
      "owasp": "A07:2021",
      "mitre": "T1068"
    },
    {
      "name": "Unrestricted Internal API",
      "extension": "*",
      "regex": "/api/.*(internal|private)",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Restrict access to internal/private APIs.",
      "category": "Access Control",
      "owasp": "A01:2021",
      "mitre": "T1190"
    },
    {
      "name": "Unprotected Session Cookie",
      "extension": "*",
      "regex": "Set-Cookie:.*(sessionid|token|auth)[^;]*;?(?!.*Secure;?)(?=.*;?HttpOnly)?",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Set Secure & HttpOnly flags for cookies.",
      "category": "Session",
      "owasp": "A07:2021",
      "mitre": "T1539"
    },
    {
      "name": "Direct Object Reference",
      "extension": "*",
      "regex": "((user|account|id|doc|file|order)_?id\\s*=\\s*.*(request|params|input))",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Validate authorization for object access.",
      "category": "Access Control",
      "owasp": "A01:2021",
      "mitre": "T1070"
    },
    {
      "name": "Exposed .git Directory",
      "extension": "*",
      "regex": "\\.git/",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Never expose .git in production.",
      "category": "Information Disclosure",
      "owasp": "A01:2021",
      "mitre": "T1552"
    },
    {
      "name": "Unrestricted Deserialization",
      "extension": "*",
      "regex": "(ObjectInputStream|pickle\\.load|Marshal\\.load)",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Block or validate types in deserialization.",
      "category": "Deserialization",
      "owasp": "A08:2021",
      "mitre": "T1649"
    },
    {
      "name": "Unsigned JWT",
      "extension": "*",
      "regex": "\"alg\"\\s*:\\s*\"none\"",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Never allow unsigned JWTs.",
      "category": "JWT",
      "owasp": "A02:2021",
      "mitre": "T1609"
    },
    {
      "name": "Sensitive Env Variable Printed",
      "extension": "*",
      "regex": "print\\s*\\(.*(os\\.environ|process\\.env).*(password|secret|token|key)",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Never print sensitive environment variables.",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "Client-Side Password Validation Only",
      "extension": ".js",
      "regex": "if.*password[^:]+length",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Always validate passwords server-side.",
      "category": "Authentication",
      "owasp": "A07:2021",
      "mitre": "T1110"
    },
    {
      "name": "Access List Allow All",
      "extension": "*",
      "regex": "(0\\.0\\.0\\.0\\/0|\\*)",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Restrict access lists to trusted hosts.",
      "category": "Misconfiguration",
      "owasp": "A05:2021",
      "mitre": "T1136"
    },
    {
      "name": "Unrestricted S3 Bucket",
      "extension": "*",
      "regex": "(\"Effect\":\\s*\"Allow\"[^\\}]*\"Principal\":\\s*\"\\*\")",
      "severity": "Critical",
      "confidence": "Sure",
      "cve": "N/A",
      "recommendation": "Restrict bucket policies to trusted users.",
      "category": "Access Control",
      "owasp": "A01:2021",
      "mitre": "T1530"
    },
    {
      "name": "Hardcoded Social Auth Secret",
      "extension": "*",
      "regex": "(facebook|google|github|twitter)_secret\\s*=\\s*['\\\"][^'\\\"]+",
      "severity": "High",
      "confidence": "Most likely",
      "cve": "N/A",
      "recommendation": "Store social auth secrets securely.",
      "category": "Secrets",
      "owasp": "A02:2021",
      "mitre": "T1552"
    },
    {
      "name": "PHP Session Without HttpOnly",
      "extension": ".php",
      "regex": "session_set_cookie_params\\([^,]+,[^,]+,[^,]+,[^,]+,[ ]*false",
      "severity": "High",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Enable HttpOnly for session cookies.",
      "category": "Session",
      "owasp": "A07:2021",
      "mitre": "T1539"
    },
    {
      "name": "Sensitive Log Statement",
      "extension": "*",
      "regex": "log\\.[a-z]*\\((.*password|.*secret|.*token|.*key)",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Do not log sensitive information.",
      "category": "Information Disclosure",
      "owasp": "A01:2021",
      "mitre": "T1552"
    },
    {
      "name": "Publicly Accessible Backup",
      "extension": "*",
      "regex": "(\\/backup\\/|\\.bak|\\.old|\\.backup)",
      "severity": "Medium",
      "confidence": "Likely",
      "cve": "N/A",
      "recommendation": "Restrict backup file access.",
      "category": "Information Disclosure",
      "owasp": "A01:2021",
      "mitre": "T1552"
    },
    {
      "name": "Vulnerable Flask Version",
      "extension": "requirements.txt",
      "regex": "flask==1\\.1\\.2",
      "severity": "High",
      "confidence": "likely",
      "cve": "CVE-2019-1010083",
      "recommendation": "Используйте Flask >=1.1.4",
      "category": "Dependency",
      "owasp": "A06:2021",
      "mitre": "T1190"
    },
    {
      "name": "Vulnerable Lodash Version",
      "extension": "package.json",
      "regex": "\"lodash\":\\s*\"[\\^~]?4\\.17\\.(0|1|2|3|4|5|6|7|8|9|10|11)\"",
      "severity": "Critical",
      "confidence": "likely",
      "cve": "CVE-2021-23337",
      "recommendation": "Используйте lodash >=4.17.21",
      "category": "Dependency",
      "owasp": "A06:2021",
      "mitre": "T1190"
    }
  ]
}
